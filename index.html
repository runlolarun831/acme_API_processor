<html>
  <head>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.js'></script>
  </head>
  <body>
    <script>
      const loadData = async()=> {
        const urls = [
          'https://acme-users-api-rev.herokuapp.com/api/companies',
          'https://acme-users-api-rev.herokuapp.com/api/products',
          'https://acme-users-api-rev.herokuapp.com/api/offerings',
        ];
      const responses = await Promise.all(urls.map( url=> axios.get(url)));

      const [companies, products, offerings ] = responses.map( response => response.data);
      //console.log(companies);
/*
      //return products within a price range
      const findProductsInPrice = (products, range) => products.filter(product => product.suggestedPrice >= range.min && product.suggestedPrice <= range.max);

      const productsInPriceRange = findProductsInPrice(products, { min: 1, max: 15});
      console.log(productsInPriceRange);
*/
/*
      // returns object where key is first letter of company name
      // value for each key is the array of those companies
      const groupCompaniesByLetter = (companies) => {
        const compNameObj = {};
        companies.map(company => {
          let first = (company.name).charAt(0);
          if( !(first in compNameObj)) {
            compNameObj[first] = [company];
          }
          else {
            compNameObj[first].push(company);
          }
        } )
        return compNameObj;
      };

      const groupedCompaniesByLetter = groupCompaniesByLetter(companies);
      console.log(groupedCompaniesByLetter);
*/
/*
      // returns object where key is a state
      // value for each key is the array of those companies in that state
      const groupCompaniesByState = (companies) => {
        const compStateObj = {};
        companies.map( company => {
          let compState = company.state;
        if ( !(compState in compStateObj)) {
            compStateObj[compState] = [company];
          }
        else {
            compStateObj[compState].push(company);
          }
        })
        return compStateObj;
      };

      const groupedCompaniesByState = groupCompaniesByState(companies);
      console.log(groupedCompaniesByState);
*/


// returns an array of offerings with each offering having a company and product

const processOfferings = ({ companies, products, offerings}) => {
  // console.log(offerings);
   //console.log( 'this is offerings sample');
   //console.log(offerings[0]);
   //console.log(offerings[0].productId);
  // find match w/products.id and add products.name to offerings
  // find match w/companies.id and add companies.name to offerings

  //console.log( 'this is products sample');
  //console.log(products[0]);
  //console.log(products[0].name);

  //console.log( 'this is companies sample');
  //console.log(companies[0]);
  //console.log(companies[0].name);
  let offProdCo = {};

  const newOfferings = [];

  [...offerings].map(offer => {
    offProdCo = offer;
    offProdCo = {...offer};//i did need it!
    const prodMatchID = [...products].find( product => {
      return product.id === offer.productId
    });
    offProdCo.product = prodMatchID.name;
    //newOfferings.push(offProdCo); //moved this

    const compMatchID = [...companies].find(company => {
      // if (company.id === offer.companyId) {
      //   console.log('FOUND company.id ', company.id, '  ', 'offer.companyId ', offer.companyId );
      // }
      return company.id === offer.companyId
    });

    offProdCo.company =compMatchID.name;

    //console.log(compMatchID.name);
    newOfferings.push(offProdCo);
  } );


  return newOfferings;

}


const processedOfferings = processOfferings( { companies, products, offerings});
//console.log(processedOfferings);
console.log(processedOfferings[0]);
console.log(offerings[0]);
console.log('check', processedOfferings === offerings) //check if you made new array and didn't change offerings


      // //example
      // const companiesByState = (companies, state) => companies.filter(company => company.state === state);

      // //returns companiesByState
      // const companiesInTexas = companiesByState(companies, 'Texas');
      // console.log(companiesInTexas);
  } ;
  loadData();

    </script>
  </body>
</html>
